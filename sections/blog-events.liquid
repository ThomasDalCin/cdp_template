<!-- events articles layout -->
<div class="blog-events-container w-full h-auto flex flex-col items-start justify-center lg:flex-wrap lg:flex-row lg:mb-10 relative overflow-hidden">
  {% if blogs['events'] %}
    {% assign eventsArticles = blogs['events'].articles %}
    {% if eventsArticles.size > 0 %}
      {% for eventArticle in eventsArticles %}
        <div class="blog-events-container w-full h-auto p-4 flex-col gap-y-2 items-start justify-center hidden lg:w-1/3">
          <div class="events-container w-full h-auto min-h-[224px] p-4 rounded-xl bg-[var(--secondary-background-color)] flex flex-col gap-y-6">
            <div class="events-details-primary w-full h-auto flex flex-col gap-y-1">
              <p class="article-title body-16-medium">{{ eventArticle.title }}</p>
              <p class="article-content body-14">{{ eventArticle.published_at }}</p>
            </div>
            <div class="events-details-secondary w-full h-auto flex flex-col gap-y-2">
              <div class="events-details-cta-primary w-auto h-auto flex flex-row gap-x-2 items-center justify-start">
                <p class="body-14 underline">Show on Google Maps</p>
                {% render 'cta-icon' %}
              </div>
              <div class="events-details-cta-secondary w-auto h-auto flex flex-row gap-x-2 items-center justify-start">
                <p class="body-14 underline">Aggiungi al Calendario</p>
                {% render 'calednar-icon' %}
              </div>
            </div>
            <div class="events-cta">
              <div class="cta-appointment book-appointment">
                <p class="body-14">Prenota appuntamento</p>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    {% endif %}
  {% endif %}

  <!-- Book appointment -->
  {% if form.posted_successfully? %}
  {% else %}
    <div class="w-full h-auto absolute bottom-0 left-0 right-0 p-4 rounded-lg shadow-custom bg-white z-30 translate-y-[1000px] transition-all duration-200 ease-in-out">
      <div class="wrapper-form-appointment w-full h-3/4 flex flex-col gap-y-6">


        <!-- Form Header -->
        <div class="form-appointement-headers w-full h-auto flex flex-col items-center justify-center relative">
          <p class="body-14 events-name"></p>

          <!-- Close Icon -->
          <div class="icon-content absolute right-0 top-0">
            {% render 'x-icon' %}
          </div>
        </div>

        <!-- Form Content -->
        <div class="form-appointment-content w-full h-auto flex flex-col items-start justify-center">
          {% form 'contact'
            , class: "w-full h-full flex flex-col items-start justify-center gap-y-3 mt-4 mb-4" %}

            <!-- Form Errors -->
            {{ form.errors | default_errors }}

            <!-- First Name -->
            <div class="form-group w-full h-auto flex flex-col items-start justify-center">
              <input
                type="text"
                name="contact[first_name]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                value="{% if form.first_name != blank %}{{ form.first_name }}{% endif %}"
                placeholder="{{ section.settings.form_first_name }}">
            </div>

            <!-- Last Name -->
            <div class="form-group w-full h-auto flex flex-col items-start justify-center">
              <input
                type="text"
                name="contact[last_name]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                value="{% if form.last_name != blank %}{{ form.last_name }}{% endif %}"
                placeholder="{{ section.settings.form_last_name }}">
            </div>

            <!-- Email -->
            <div class="form-group w-full h-auto flex flex-col items-start justify-center">
              <input
                type="email"
                name="contact[email]"
                value="{% if form.email != blank %}{{ form.email }}{% endif %}"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                placeholder="{{ section.settings.form_email }}"
                required>
            </div>

            <!-- Message -->
            <div class="form-group w-full h-auto flex flex-col items-start justify-center">
              <textarea
                name="contact[message]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                placeholder="{{ section.settings.form_content }} {% if form.message != blank %}{{ form.message }}{% endif %}"></textarea>
            </div>

            <!-- Privacy Policy -->
            <div class="form-group w-full flex flex-row gap-x-1 items-center justify-start mt-6">
              <input
                type="checkbox"
                id="privacy_policy"
                name="contact[privacy]"
                class="w-4 h-4 border-gray-300 rounded"
                required>
              <label for="privacy_policy" class="text-sm text-gray-700">
                Privacy Policy*
              </label>
            </div>

            <!-- Secondary Info -->
            <p class="caption text-[#7A7A7A]">{{ section.settings.form_privacy }}</p>

            <!-- Submit Button -->
            <div class="cta-accent">
              <button type="submit" id="Subscribe">{{ section.settings.form_cta }}</button>
              {% render 'cta-icon' %}
            </div>

          {% endform %}
        </div>

      </div>
    </div>
  {% endif %}
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
  // Seleziona tutti i pulsanti "Prenota appuntamento"
  const appointmentButtons = document.querySelectorAll('.book-appointment');
  
  // Seleziona il div del form e l'elemento dove inserire il titolo dell'evento
  const formContainer = document.querySelector('.w-full.h-auto.absolute.bottom-0'); // Div del form
  const eventNameElement = formContainer.querySelector('.events-name'); // Elemento <p> dove verrà inserito il titolo
  
  // Aggiungi un evento di click a ogni pulsante "Prenota appuntamento"
  appointmentButtons.forEach(button => {
    button.addEventListener('click', function() {
      // Risali fino al titolo dell'articolo
      const articleTitle = this.closest('.events-container').querySelector('.article-title').innerText;
      
      // Popola il titolo dell'evento nel form
      eventNameElement.textContent = articleTitle;
  
      // Mostra il form rimuovendo la classe translate-y-[1000px]
      formContainer.classList.remove('translate-y-[1000px]');
  
      // Aggiungi eventualmente una transizione o modifica la durata
      formContainer.classList.add('translate-y-0'); // Per assicurarsi che il div si mostri completamente
    });
  });
  
  // Chiudi il form quando si clicca sull'icona di chiusura
  const closeIcon = formContainer.querySelector('.icon-content');
  closeIcon.addEventListener('click', function() {
    // Nasconde nuovamente il form aggiungendo la classe translate-y-[1000px]
    formContainer.classList.add('translate-y-[1000px]');
  });
  });
</script>

{% schema %}
  {
    "name": "contact-form",
    "settings": [
      {
        "type": "text",
        "id": "form_first_name",
        "label": "Form Name",
        "default": "Name"
      },
      {
        "type": "text",
        "id": "form_last_name",
        "label": "Last Name",
        "default": "Last Name"
      },
      {
        "type": "text",
        "id": "form_email",
        "label": "Email",
        "default": "Email*"
      },
      {
        "type": "text",
        "id": "form_content",
        "label": "Message",
        "default": "Message"
      }, {
        "type": "textarea",
        "id": "form_privacy",
        "label": "Secondary Info",
        "default": "Desidero ricevere comunicazioni di marketing su prodotti, servizi ed eventi offerti da CANTIERE DEL PARDO S.p.A. Comprendo che queste comunicazioni potrebbero essere personalizzate in base ai miei interessi, preferenze e utilizzo di prodotti e servizi, inclusi inviti a fornire feedback sull’esperienza del cliente."
      }, {
        "type": "text",
        "id": "form_cta",
        "label": "CTA Text",
        "default": "Send"
      }
    ]
  }
{% endschema %}