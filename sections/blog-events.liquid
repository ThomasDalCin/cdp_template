<div class="blog-events-container w-full h-auto flex flex-col items-start justify-center lg:flex-wrap lg:flex-row lg:mb-10 relative overflow-hidden">

  {% if form.posted_successfully? %}
    <!-- Confirm pop-up -->
    <div class="confirm-pop-up w-full h-auto fixed bottom-0 right-0 left-0 p-4 flex flex-col items-start justify-between rounded-lg border border-black bg-white hidden transition-opacity duration-300 ease-in-out">
      {% render 'check-icon' %}
      <p class="body-12">{{ section.settings.confirm_message }}</p>
    </div>
  {% else %}
    <!-- Form container per dispositivi mobili -->
    <div class="form-container w-full h-auto p-4 rounded-lg shadow-custom bg-white z-30 lg:hidden">
      <div class="wrapper-form-appointment w-full h-auto flex flex-col gap-y-6">
        <!-- Form Header -->
        <div class="form-appointment-headers w-full h-auto flex flex-col items-center justify-center relative">
          <p class="body-14-medium events-name"></p>

          <!-- Close Icon -->
          <div class="icon-content absolute right-0 top-0 cursor-pointer">
            {% render 'x-icon' %}
          </div>
        </div>

        <!-- Form Content -->
        <div class="form-appointment-content w-full h-auto flex flex-col items-start justify-center">
          {% form 'contact', class: "w-full h-full flex flex-col items-start justify-center gap-y-3 mt-4 mb-4" %}
            <!-- Form Errors -->
            {{ form.errors | default_errors }}
            <!-- Nome -->
            <div class="form-group w-full">
              <input
                type="text"
                name="contact[first_name]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                value="{% if form.first_name != blank %}{{ form.first_name }}{% endif %}"
                placeholder="{{ section.settings.form_first_name }}" required>
            </div>
            <!-- Cognome -->
            <div class="form-group w-full">
              <input
                type="text"
                name="contact[last_name]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                value="{% if form.last_name != blank %}{{ form.last_name }}{% endif %}"
                placeholder="{{ section.settings.form_last_name }}" required>
            </div>
            <!-- Email -->
            <div class="form-group w-full">
              <input
                type="email"
                name="contact[email]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                value="{% if form.email != blank %}{{ form.email }}{% endif %}"
                placeholder="{{ section.settings.form_email }}" required>
            </div>
            <!-- Messaggio -->
            <div class="form-group w-full">
              <textarea
                name="contact[message]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-[var(--primary-background-color)]"
                placeholder="{{ section.settings.form_content }} {% if form.message != blank %}{{ form.message }}{% endif %}"></textarea>
            </div>
            <!-- Privacy Policy -->
            <div class="form-group w-full flex flex-row gap-x-1 items-center justify-start mt-6">
              <input
                type="checkbox"
                id="privacy_policy"
                name="contact[privacy]"
                class="w-4 h-4 border-gray-300 rounded" required>
              <label for="privacy_policy" class="text-sm text-gray-700">
                Privacy Policy*
              </label>
            </div>
            <!-- Informazioni secondarie -->
            <p class="caption text-[#7A7A7A]">{{ section.settings.form_privacy }}</p>
            <!-- Pulsante di invio -->
            <div class="cta-accent">
              <button type="submit" id="Subscribe">{{ section.settings.form_cta }}</button>
              {% render 'cta-icon' %}
            </div>
          {% endform %}
        </div>
      </div>
    </div>

    <!-- Form container per dispositivi lg e superiori -->
    <div class="fixed inset-0 w-full h-full flex items-center justify-center backdrop-blur-md bg-black/50 z-50 hidden lg:flex">
      <div class="w-[640px] h-auto bg-white p-8 rounded-lg shadow-lg">
        <div class="form-appointment-headers w-full h-auto flex items-center justify-between mb-4">
          <p class="body-14-medium events-name">Prenota appuntamento</p>
          <!-- Icona di chiusura -->
          <div class="icon-content cursor-pointer">
            {% render 'x-icon' %}
          </div>
        </div>

        <!-- Form -->
        <div class="form-appointment-content w-full h-auto">
          {% form 'contact', class: "w-full h-auto flex flex-col gap-y-4" %}
            <!-- Errori del form -->
            {{ form.errors | default_errors }}
            <!-- Nome -->
            <div class="form-group w-full">
              <input
                type="text"
                name="contact[first_name]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-gray-100 border border-gray-300"
                value="{% if form.first_name != blank %}{{ form.first_name }}{% endif %}"
                placeholder="{{ section.settings.form_first_name }}" required>
            </div>

            <!-- Cognome -->
            <div class="form-group w-full">
              <input
                type="text"
                name="contact[last_name]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-gray-100 border border-gray-300"
                value="{% if form.last_name != blank %}{{ form.last_name }}{% endif %}"
                placeholder="{{ section.settings.form_last_name }}" required>
            </div>

            <!-- Email -->
            <div class="form-group w-full">
              <input
                type="email"
                name="contact[email]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-gray-100 border border-gray-300"
                value="{% if form.email != blank %}{{ form.email }}{% endif %}"
                placeholder="{{ section.settings.form_email }}" required>
            </div>

            <!-- Messaggio -->
            <div class="form-group w-full">
              <textarea
                name="contact[message]"
                class="w-full h-auto px-4 py-3 rounded-lg bg-gray-100 border border-gray-300"
                placeholder="{{ section.settings.form_content }} {% if form.message != blank %}{{ form.message }}{% endif %}"></textarea>
            </div>

            <!-- Privacy Policy -->
            <div class="form-group w-full flex flex-row gap-x-1 items-center justify-start mt-6">
              <input
                type="checkbox"
                id="privacy_policy"
                name="contact[privacy]"
                class="w-4 h-4 border-gray-300 rounded" required>
              <label for="privacy_policy" class="text-sm text-gray-700">
                Privacy Policy*
              </label>
            </div>

            <!-- Informazioni secondarie -->
            <p class="caption text-[#7A7A7A]">{{ section.settings.form_privacy }}</p>

            <!-- Pulsante di invio -->
            <div class="cta-accent">
              <button type="submit" id="Subscribe">{{ section.settings.form_cta }}</button>
              {% render 'cta-icon' %}
            </div>

          {% endform %}
        </div>
      </div>
    </div>
  {% endif %}
</div>


<script>
  document.addEventListener("DOMContentLoaded", function() {
    const appointmentButtons = document.querySelectorAll('.book-appointment');
    const formContainer = document.querySelector('.form-container');
    const eventNameElement = formContainer.querySelector('.events-name');
    const confirmPopup = document.querySelector('.confirm-pop-up'); 
    const closeIcon = formContainer.querySelector('.icon-content');

    appointmentButtons.forEach(button => {
      button.addEventListener('click', function() {
        const articleTitle = this.closest('.events-container').querySelector('.article-title').innerText;
        eventNameElement.textContent = articleTitle;
        formContainer.classList.remove('hidden');
        formContainer.classList.remove('translate-y-full'); 
        formContainer.classList.add('translate-y-0'); 
      });
    });

    closeIcon.addEventListener('click', function() {
      formContainer.classList.add('translate-y-full');
      setTimeout(() => {
        formContainer.classList.add('hidden');
      }, 300); 
    });

   
    {% if form.posted_successfully? %}
      formContainer.classList.add('translate-y-full');
      setTimeout(() => {
        formContainer.classList.add('hidden');
      }, 300); 
      confirmPopup.classList.remove('hidden'); 

    
      setTimeout(() => {
        confirmPopup.classList.add('hidden');
      }, 3000);
    {% endif %}
  });
</script>


{% schema %}
  {
    "name": "contact-form",
    "settings": [
      {
        "type": "text",
        "id": "confirm_message",
        "label": "Confirm form message",
        "default": "Request sent"
      },
      {
        "type": "text",
        "id": "form_first_name",
        "label": "Form Name",
        "default": "Name"
      },
      {
        "type": "text",
        "id": "form_last_name",
        "label": "Last Name",
        "default": "Last Name"
      },
      {
        "type": "text",
        "id": "form_email",
        "label": "Email",
        "default": "Email*"
      },
      {
        "type": "text",
        "id": "form_content",
        "label": "Message",
        "default": "Message"
      }, {
        "type": "textarea",
        "id": "form_privacy",
        "label": "Secondary Info",
        "default": "Desidero ricevere comunicazioni di marketing su prodotti, servizi ed eventi offerti da CANTIERE DEL PARDO S.p.A. Comprendo che queste comunicazioni potrebbero essere personalizzate in base ai miei interessi, preferenze e utilizzo di prodotti e servizi, inclusi inviti a fornire feedback sull’esperienza del cliente."
      }, {
        "type": "text",
        "id": "form_cta",
        "label": "CTA Text",
        "default": "Send"
      }
    ]
  }
{% endschema %}


